# Name:
    extract_unmapped_pairs

# Description
    Converts unmapped BAMs generated by `make extract_unmapped` into paired BAM
    and FASTQ assets for downstream viral discovery pipelines.  Implemented in
    `fastq_tools/extractunmappedpairs.mk`.

# Input
    - `unmapped_reads/<sample>.bam` - the unmapped-only BAM emitted by
      `extract_unmapped`.

# Output
```
extracted_reads/unmapped_pairs/<sample>.txt      # read IDs retained in the pair
extracted_reads/unmapped_pairs/<sample>.bam      # BAM filtered to those read IDs
extracted_reads/unmapped_pairs/<sample>_1.fastq
extracted_reads/unmapped_pairs/<sample>_2.fastq
```

# Usage
```
make extract_unmapped USE_CLUSTER=false
make extract_unmapped_pairs USE_CLUSTER=false
```
    `bamToFastq` (from Picard) is used for the BAMâ†’FASTQ conversion, so ensure
    Picard is available at the path defined in `config.inc`.

# Notes
- The read-ID list is regenerated from `unmapped_reads/*.bam` each time, keeping
  the subset consistent with the current BAM contents.
- FASTQs are left uncompressed so downstream tools (e.g. Krona workflows) can
  ingest them without gunzip; compress manually if required.
- Combine with `make bam_to_fasta`, `make blast_reads`, and
  `make krona_classify` to complete the viral detection suite.
