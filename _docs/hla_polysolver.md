# Name:
    hla_polysolver

# Description
    Automates the Polysolver HLA typing and mutation annotation pipeline via
    `variant_callers/somatic/polysolver.mk`.  For each tumor/normal pair the rule
    calls Polysolver, generates interval lists, annotates Mutect and Strelka
    results within the HLA region, and emits project-level summaries.

# Inputs
    - `bam/<tumor>.bam` and `bam/<normal>.bam` symlinks defined by
      `SAMPLE_PAIRS` (run `make config` first).
    - `POLYSOLVER_ENV` pointing to a Conda/virtualenv installation that
      provides `shell_call_hla_type`, `shell_call_hla_mutations_from_type`, and
      `shell_annotate_hla_mutations`.

# Outputs
```
hla_polysolver/<pair>/winners.hla.txt
hla_polysolver/<pair>/hla.intervals
hla_polysolver/<pair>/<pair>.mutect.unfiltered.annotated
hla_polysolver/<pair>/<pair>.strelka_indels.unfiltered.annotated
hla_polysolver/summary/hla_summary.txt
hla_polysolver/summary/mutect_summary.txt
hla_polysolver/summary/strelka_summary.txt
version/hla_polysolver.txt   # tool version log
```

# Usage
```
make hla_polysolver USE_CLUSTER=false    # run locally
```
    Remove `USE_CLUSTER=false` to submit through qmake with the memory/core
    requests defined in the makefile.

# Notes
- The wrapper exports `PERL5LIB` based on the chosen `POLYSOLVER_ENV`; verify
  the environment contains the expected Perl modules.
- Summaries are generated by `variant_callers/somatic/hla_summary.R` and provide
  quick inspection tables for alleles and supporting variants.
- Polysolver expects hg19/B37 BAMs.  If your project uses a different build,
  adjust the `hg19` arguments in the makefile accordingly.
